\hypertarget{remote__control_2include_2hardwareglobalinterface_8h_source}{}\doxysection{hardwareglobalinterface.\+h}
\label{remote__control_2include_2hardwareglobalinterface_8h_source}\index{X:/remote\_control/include/hardwareglobalinterface.h@{X:/remote\_control/include/hardwareglobalinterface.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef HARDWAREGLOBALINTERFACE\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define HARDWAREGLOBALINTERFACE\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#define LOC\_REALSENSE}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <single\_thread.hpp>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}hardwareparameters.h"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}robotstatus.h"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}personitem.h"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <Subscriber.hpp>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <RequesterSimple.hpp>}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define LOC\_TIMEOUT 50}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#define HW\_TIMEOUT 50}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#define LIDAR\_TIMEOUT 200}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#define TRACKING\_TIMEOUT 200}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keyword}{class }\mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}}}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26 \textcolor{keyword}{public}:}
\DoxyCodeLine{27 }
\DoxyCodeLine{28   \textcolor{keyword}{static} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}} \& getInstance() \{}
\DoxyCodeLine{29 }
\DoxyCodeLine{30     \textcolor{keywordflow}{if}(instances.size()<1) \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Robot not initialized"{}});}
\DoxyCodeLine{31     \textcolor{keywordflow}{return} *instances.at(0);}
\DoxyCodeLine{32   \}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34   \textcolor{keyword}{static} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}} \& getInstance(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i) \{}
\DoxyCodeLine{35 }
\DoxyCodeLine{36     \textcolor{keywordflow}{if}(instances.size()<i) \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Robot not initialized"{}});}
\DoxyCodeLine{37     \textcolor{keywordflow}{return} *instances.at(i);}
\DoxyCodeLine{38   \}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40   \textcolor{keyword}{static} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}} \& initialize() \{}
\DoxyCodeLine{41 }
\DoxyCodeLine{42     instances.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}}(\textcolor{keyword}{new} \mbox{\hyperlink{struct_hardware_parameters}{HardwareParameters}}()));}
\DoxyCodeLine{43     \textcolor{keywordflow}{return} *instances.back();}
\DoxyCodeLine{44   \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 }
\DoxyCodeLine{47   \textcolor{keyword}{static} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}} \&initialize(\mbox{\hyperlink{struct_hardware_parameters}{HardwareParameters}}* hp)\{}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 }
\DoxyCodeLine{50     instances.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}}(hp));}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     instances.back()-\/>params = hp;}
\DoxyCodeLine{53 }
\DoxyCodeLine{54     instances.back()-\/>frontLidar.setMountingPosition(0,0);}
\DoxyCodeLine{55     instances.back()-\/>rearLidar.setMountingPosition(-\/0.7,0);}
\DoxyCodeLine{56     instances.back()-\/>realSenseLidar.setMountingPosition(hp-\/>cameraOffsetX,hp-\/>cameraOffsetY);}
\DoxyCodeLine{57 }
\DoxyCodeLine{58     instances.back()-\/>subLoc.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{59     instances.back()-\/>subLoc-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>sub\_locSubscriber(topic,buf,size,data);\});}
\DoxyCodeLine{60     instances.back()-\/>subLoc-\/>start(hp-\/>localizationPublisher,\textcolor{stringliteral}{"{}LOC"{}});}
\DoxyCodeLine{61 }
\DoxyCodeLine{62     instances.back()-\/>subLocKarto.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{63     instances.back()-\/>subLocKarto-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>sub\_locSubscriberKarto(topic,buf,size,data);\});}
\DoxyCodeLine{64     instances.back()-\/>subLocKarto-\/>start(hp-\/>kartoPosePublisher,\textcolor{stringliteral}{"{}POS"{}});}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     instances.back()-\/>subLocRealSense.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{67     instances.back()-\/>subLocRealSense-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>sub\_locSubscriberRealSense(topic,buf,size,data);\});}
\DoxyCodeLine{68     instances.back()-\/>subLocRealSense-\/>start(hp-\/>realSensePosePublisher,\textcolor{stringliteral}{"{}POS"{}});}
\DoxyCodeLine{69 }
\DoxyCodeLine{70     instances.back()-\/>subHW.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{71     instances.back()-\/>subHW-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>subHW\_callback(topic,buf,size,data);\});}
\DoxyCodeLine{72     instances.back()-\/>subHW-\/>start(hp-\/>hardwarePublisher,\textcolor{stringliteral}{"{}PUB\_HW"{}});}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     instances.back()-\/>subHWTrolley.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{75     instances.back()-\/>subHWTrolley-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>subHW\_trolley(topic,buf,size,data);\});}
\DoxyCodeLine{76     instances.back()-\/>subHWTrolley-\/>start(hp-\/>trolleyPublisher,\textcolor{stringliteral}{"{}PUB\_HW"{}});}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     instances.back()-\/>subFrontLidar.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{79     instances.back()-\/>subFrontLidar-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>sub\_frontLidar(topic,buf,size,data);\});}
\DoxyCodeLine{80     instances.back()-\/>subFrontLidar-\/>start(hp-\/>frontLidarPublisher,\textcolor{stringliteral}{"{}LIDAR"{}});}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     instances.back()-\/>subRealSense.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{83     instances.back()-\/>subRealSense-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>sub\_realSenseLidar(topic,buf,size,data);\});}
\DoxyCodeLine{84     instances.back()-\/>subRealSense-\/>start(hp-\/>realSensePublisher,\textcolor{stringliteral}{"{}LIDAR"{}});}
\DoxyCodeLine{85 }
\DoxyCodeLine{86     instances.back()-\/>subRearLidar.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{87     instances.back()-\/>subRearLidar-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>sub\_rearLidar(topic,buf,size,data);\});}
\DoxyCodeLine{88     instances.back()-\/>subRearLidar-\/>start(hp-\/>rearLidarPublisher,\textcolor{stringliteral}{"{}LIDAR"{}});}
\DoxyCodeLine{89 }
\DoxyCodeLine{90     instances.back()-\/>subTracking.reset(\textcolor{keyword}{new} ZMQCommon::Subscriber());}
\DoxyCodeLine{91     instances.back()-\/>subTracking-\/>register\_callback([\&](\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data)\{instances.back()-\/>sub\_tracking(topic,buf,size,data);\});}
\DoxyCodeLine{92     instances.back()-\/>subTracking-\/>start(hp-\/>trackingPublisher,\textcolor{stringliteral}{"{}PUB\_TRACKER"{}});}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 }
\DoxyCodeLine{95     instances.back()-\/>reqHW.reset(\textcolor{keyword}{new} ZMQCommon::RequesterSimple(hp-\/>hardwareServer));}
\DoxyCodeLine{96     instances.back()-\/>reqLoc.reset(\textcolor{keyword}{new} ZMQCommon::RequesterSimple(hp-\/>localizationServer));}
\DoxyCodeLine{97 }
\DoxyCodeLine{98     \textcolor{keywordflow}{return} *instances.back();}
\DoxyCodeLine{99   \}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101   \textcolor{keywordtype}{bool} getLocalizationData(RobotStatus::LocalizationData \&locData)\{}
\DoxyCodeLine{102     std::unique\_lock<std::mutex> lock(locDataMTX);}
\DoxyCodeLine{103     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{104     locData = this-\/>locData;}
\DoxyCodeLine{105     \textcolor{keywordflow}{if}(currTime -\/ this-\/>locData.locTimer < LOC\_TIMEOUT)\{}
\DoxyCodeLine{106       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{107     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{108       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{109     \}}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   \mbox{\hyperlink{struct_hardware_parameters}{HardwareParameters}} getParams() \{}
\DoxyCodeLine{113     \mbox{\hyperlink{struct_hardware_parameters}{HardwareParameters}} res;}
\DoxyCodeLine{114     \textcolor{keywordflow}{if} (params)}
\DoxyCodeLine{115       res = *params;}
\DoxyCodeLine{116     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{117   \}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119   \textcolor{keywordtype}{bool} getLocalizationDataKarto(RobotStatus::LocalizationData \&locDataKarto)\{}
\DoxyCodeLine{120     std::unique\_lock<std::mutex> lock(locDataKartoMTX);}
\DoxyCodeLine{121     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{122     locDataKarto = this-\/>locDataKarto;}
\DoxyCodeLine{123     \textcolor{keywordflow}{if}(currTime -\/ this-\/>locDataKarto.locTimer < LOC\_TIMEOUT)\{}
\DoxyCodeLine{124       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{125     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{126       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{127     \}}
\DoxyCodeLine{128   \}}
\DoxyCodeLine{129 }
\DoxyCodeLine{130   \textcolor{keywordtype}{bool} getLocalizationDataRealSense(RobotStatus::LocalizationData \&locDataRealSense)\{}
\DoxyCodeLine{131     std::unique\_lock<std::mutex> lock(locDataRealSenseMTX);}
\DoxyCodeLine{132     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{133     locDataRealSense = this-\/>locDataRealSense;}
\DoxyCodeLine{134     \textcolor{keywordflow}{if}(currTime -\/ this-\/>locDataRealSense.locTimer < LOC\_TIMEOUT)\{}
\DoxyCodeLine{135       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{136     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{137       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{138     \}}
\DoxyCodeLine{139   \}}
\DoxyCodeLine{140 }
\DoxyCodeLine{141   \textcolor{keywordtype}{bool} getHardwareData(RobotStatus::HardwareData \&hwData)\{}
\DoxyCodeLine{142     std::unique\_lock<std::mutex> lock(hwDataMTX);}
\DoxyCodeLine{143     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{144     hwData = this-\/>hwData;}
\DoxyCodeLine{145     \textcolor{keywordflow}{if}(currTime -\/ this-\/>hwData.hardwareTimer < HW\_TIMEOUT)\{}
\DoxyCodeLine{146       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{147     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{148       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{149     \}}
\DoxyCodeLine{150   \}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152   \textcolor{keywordtype}{bool} getTrolleyData(RobotStatus::TrolleyData \&trolleyData)\{}
\DoxyCodeLine{153     std::unique\_lock<std::mutex> lock(trolleyDataMTX);}
\DoxyCodeLine{154     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{155     trolleyData = this-\/>trolleyData;}
\DoxyCodeLine{156     \textcolor{keywordflow}{if}(currTime -\/ this-\/>trolleyData.trolleyTimer < HW\_TIMEOUT)\{}
\DoxyCodeLine{157       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{158     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{159       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{160     \}}
\DoxyCodeLine{161   \}}
\DoxyCodeLine{162 }
\DoxyCodeLine{163   \textcolor{comment}{//    bool subTracker\_callback(RobotStatus::TrackerData \&trackerData)\{}}
\DoxyCodeLine{164   \textcolor{comment}{//        std::unique\_lock<std::mutex> lock(trackerDataMTX);}}
\DoxyCodeLine{165   \textcolor{comment}{//        double currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}}
\DoxyCodeLine{166   \textcolor{comment}{//        trackerData = this-\/>trackerData;}}
\DoxyCodeLine{167   \textcolor{comment}{//        if(currTime -\/ this-\/>trackerData.trackerTimer < TRACKER\_TIMEOUT)\{}}
\DoxyCodeLine{168   \textcolor{comment}{//            return true;}}
\DoxyCodeLine{169   \textcolor{comment}{//        \}else\{}}
\DoxyCodeLine{170   \textcolor{comment}{//            return false;}}
\DoxyCodeLine{171   \textcolor{comment}{//        \}}}
\DoxyCodeLine{172   \textcolor{comment}{//    \}// subTracker\_callback(const char *topic, const char *buf, size\_t size, void *data)}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174   \textcolor{keywordtype}{bool} getFrontLidarData(RobotStatus::LidarData \&lidarData)\{}
\DoxyCodeLine{175     std::unique\_lock<std::mutex> lock(frontLidarMTX);}
\DoxyCodeLine{176     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{177     lidarData = this-\/>frontLidar;}
\DoxyCodeLine{178     \textcolor{keywordflow}{if}(currTime -\/ this-\/>frontLidar.lidarTimer < LIDAR\_TIMEOUT)\{}
\DoxyCodeLine{179       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{180     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{181       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{182     \}}
\DoxyCodeLine{183   \}}
\DoxyCodeLine{184 }
\DoxyCodeLine{185   \textcolor{keywordtype}{bool} getRearLidarData(RobotStatus::LidarData \&lidarData)\{}
\DoxyCodeLine{186     std::unique\_lock<std::mutex> lock(rearLidarMTX);}
\DoxyCodeLine{187     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{188     lidarData = this-\/>rearLidar;}
\DoxyCodeLine{189     \textcolor{keywordflow}{if}(currTime -\/ this-\/>rearLidar.lidarTimer < LIDAR\_TIMEOUT)\{}
\DoxyCodeLine{190       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{191     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{192       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{193     \}}
\DoxyCodeLine{194   \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196   \textcolor{keywordtype}{bool} getRealSenseLidarData(RobotStatus::LidarData \&lidarData)\{}
\DoxyCodeLine{197     std::unique\_lock<std::mutex> lock(realSenseLidarMTX);}
\DoxyCodeLine{198     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{199     lidarData = this-\/>realSenseLidar;}
\DoxyCodeLine{200     \textcolor{keywordflow}{if}(currTime -\/ this-\/>realSenseLidar.lidarTimer < LIDAR\_TIMEOUT)\{}
\DoxyCodeLine{201       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{202     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{203       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{204     \}}
\DoxyCodeLine{205   \}}
\DoxyCodeLine{206 }
\DoxyCodeLine{207   \textcolor{keywordtype}{bool} getTrackingData(std::vector<PersonItem> \&trackingData)\{}
\DoxyCodeLine{208     std::unique\_lock<std::mutex> lock(trackingMTX);}
\DoxyCodeLine{209     \textcolor{keywordtype}{double} currTime = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count();}
\DoxyCodeLine{210     trackingData = this-\/>trackingData;}
\DoxyCodeLine{211     \textcolor{keywordflow}{if}(currTime -\/ this-\/>trackingTimer < TRACKING\_TIMEOUT)\{}
\DoxyCodeLine{212       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{213     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{214       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{215     \}}
\DoxyCodeLine{216   \}}
\DoxyCodeLine{217 }
\DoxyCodeLine{218 }
\DoxyCodeLine{219   \mbox{\hyperlink{class_hardware_global_interface}{\string~HardwareGlobalInterface}}();}
\DoxyCodeLine{220 }
\DoxyCodeLine{221   \textcolor{keywordtype}{void} robotOnVelControl();}
\DoxyCodeLine{222   \textcolor{keywordtype}{void} robotOnCurrControl();}
\DoxyCodeLine{223   \textcolor{keywordtype}{void} robotOff();}
\DoxyCodeLine{224   \textcolor{keywordtype}{void} vehicleMove(\textcolor{keywordtype}{float} vel, \textcolor{keywordtype}{float} omega);}
\DoxyCodeLine{225   \textcolor{comment}{//Safely move the vehicle since it ckecks for possible collisions}}
\DoxyCodeLine{226   \textcolor{keywordtype}{void} vehicleSafeMove(\textcolor{keywordtype}{float} vel, \textcolor{keywordtype}{float} omega);}
\DoxyCodeLine{227   \textcolor{keywordtype}{void} setLocalization(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} y, \textcolor{keywordtype}{double} theta);}
\DoxyCodeLine{228   \textcolor{keywordtype}{void} setCurrent(\textcolor{keywordtype}{double} i\_r, \textcolor{keywordtype}{double} i\_l);}
\DoxyCodeLine{229   \textcolor{keywordtype}{void} calibrateTrolley();}
\DoxyCodeLine{230   \textcolor{keywordtype}{void} getLastInputs(\textcolor{keywordtype}{double} \&v, \textcolor{keywordtype}{double} \&omega);}
\DoxyCodeLine{231   \textcolor{keywordtype}{void} getBrakingCoefficient(\textcolor{keywordtype}{double} \&bc);}
\DoxyCodeLine{232 }
\DoxyCodeLine{233 \textcolor{keyword}{private}:}
\DoxyCodeLine{234 }
\DoxyCodeLine{235   \textcolor{keyword}{static} std::vector<HardwareGlobalInterface *> instances;}
\DoxyCodeLine{236 }
\DoxyCodeLine{237   \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}}();}
\DoxyCodeLine{238   \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}}(\mbox{\hyperlink{struct_hardware_parameters}{HardwareParameters}}* hp);}
\DoxyCodeLine{239 }
\DoxyCodeLine{240   \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}} \&rs) \{}
\DoxyCodeLine{241     instances = rs.instances;}
\DoxyCodeLine{242   \}}
\DoxyCodeLine{243 }
\DoxyCodeLine{244   \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}} \&operator=(\textcolor{keyword}{const} \mbox{\hyperlink{class_hardware_global_interface}{HardwareGlobalInterface}} \&rs) \{}
\DoxyCodeLine{245     \textcolor{keywordflow}{if} (\textcolor{keyword}{this} != \&rs) \{}
\DoxyCodeLine{246       instances = rs.instances;}
\DoxyCodeLine{247     \}}
\DoxyCodeLine{248 }
\DoxyCodeLine{249     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{250   \}}
\DoxyCodeLine{251 }
\DoxyCodeLine{252   std::mutex locDataMTX;}
\DoxyCodeLine{253   RobotStatus::LocalizationData locData;}
\DoxyCodeLine{254   std::unique\_ptr<ZMQCommon::Subscriber> subLoc;}
\DoxyCodeLine{255 }
\DoxyCodeLine{256   std::mutex locDataKartoMTX;}
\DoxyCodeLine{257   RobotStatus::LocalizationData locDataKarto;}
\DoxyCodeLine{258   std::unique\_ptr<ZMQCommon::Subscriber> subLocKarto;}
\DoxyCodeLine{259 }
\DoxyCodeLine{260   std::mutex locDataRealSenseMTX;}
\DoxyCodeLine{261   RobotStatus::LocalizationData locDataRealSense;}
\DoxyCodeLine{262   std::unique\_ptr<ZMQCommon::Subscriber> subLocRealSense;}
\DoxyCodeLine{263 }
\DoxyCodeLine{264   std::mutex hwDataMTX;}
\DoxyCodeLine{265   RobotStatus::HardwareData hwData;}
\DoxyCodeLine{266   std::unique\_ptr<ZMQCommon::Subscriber> subHW;}
\DoxyCodeLine{267 }
\DoxyCodeLine{268   std::mutex trolleyDataMTX;}
\DoxyCodeLine{269   RobotStatus::TrolleyData trolleyData;}
\DoxyCodeLine{270   std::unique\_ptr<ZMQCommon::Subscriber> subHWTrolley;}
\DoxyCodeLine{271 }
\DoxyCodeLine{272   \textcolor{comment}{//    std::mutex trackerDataMTX;}}
\DoxyCodeLine{273   \textcolor{comment}{//    RobotStatus::TrackerData trackerData;}}
\DoxyCodeLine{274   \textcolor{comment}{//    std::unique\_ptr<ZMQCommon::Subscriber> subTracker;}}
\DoxyCodeLine{275 }
\DoxyCodeLine{276   std::mutex frontLidarMTX;}
\DoxyCodeLine{277   RobotStatus::LidarData frontLidar;}
\DoxyCodeLine{278   std::unique\_ptr<ZMQCommon::Subscriber> subFrontLidar;}
\DoxyCodeLine{279 }
\DoxyCodeLine{280   std::mutex rearLidarMTX;}
\DoxyCodeLine{281   RobotStatus::LidarData rearLidar;}
\DoxyCodeLine{282   std::unique\_ptr<ZMQCommon::Subscriber> subRearLidar;}
\DoxyCodeLine{283 }
\DoxyCodeLine{284   std::mutex realSenseLidarMTX;}
\DoxyCodeLine{285   RobotStatus::LidarData realSenseLidar;}
\DoxyCodeLine{286   std::unique\_ptr<ZMQCommon::Subscriber> subRealSense;}
\DoxyCodeLine{287 }
\DoxyCodeLine{288   std::mutex trackingMTX;}
\DoxyCodeLine{289   std::vector<PersonItem> trackingData;}
\DoxyCodeLine{290   \textcolor{keywordtype}{double} trackingTimer;}
\DoxyCodeLine{291   std::unique\_ptr<ZMQCommon::Subscriber> subTracking;}
\DoxyCodeLine{292 }
\DoxyCodeLine{293 }
\DoxyCodeLine{294   std::unique\_ptr<ZMQCommon::RequesterSimple> reqHW;}
\DoxyCodeLine{295   std::unique\_ptr<ZMQCommon::RequesterSimple> reqLoc;}
\DoxyCodeLine{296 }
\DoxyCodeLine{297   std::mutex dataMTX;}
\DoxyCodeLine{298 }
\DoxyCodeLine{299   \textcolor{keywordtype}{void} sub\_locSubscriber(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{300   \textcolor{keywordtype}{void} subHW\_callback(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{301   \textcolor{keywordtype}{void} subHW\_trolley(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{302   \textcolor{keywordtype}{void} sub\_frontLidar(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{303   \textcolor{keywordtype}{void} sub\_realSenseLidar(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{304   \textcolor{keywordtype}{void} sub\_rearLidar(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{305   \textcolor{keywordtype}{void} sub\_locSubscriberKarto(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{306   \textcolor{keywordtype}{void} sub\_locSubscriberRealSense(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{307   \textcolor{keywordtype}{void} sub\_tracking(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *topic, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *buf, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{308 }
\DoxyCodeLine{309   \mbox{\hyperlink{struct_hardware_parameters}{HardwareParameters}}* params = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{310   \textcolor{keywordtype}{double} safetyWidth = 0.3;}
\DoxyCodeLine{311   \textcolor{keywordtype}{double} criticalDistance = 0.2;}
\DoxyCodeLine{312 }
\DoxyCodeLine{313   \textcolor{keywordtype}{double} ha = 0.25; \textcolor{comment}{//0.1; //distanza x della punta del veicolo rispetto al suo sistema di riferimento}}
\DoxyCodeLine{314   \textcolor{keywordtype}{double} hb = 0.25; \textcolor{comment}{//0.7; //distanza x della coda del veicolo rispetto al suo sistema di riferimento}}
\DoxyCodeLine{315   \textcolor{keywordtype}{double} width = 0.5; \textcolor{comment}{//larghezza veicolo}}
\DoxyCodeLine{316   \textcolor{keywordtype}{double} length = 0.5;}
\DoxyCodeLine{317 }
\DoxyCodeLine{318   \textcolor{keywordtype}{double} lastInputVel = 0;}
\DoxyCodeLine{319   \textcolor{keywordtype}{double} lastInputOmega = 0;}
\DoxyCodeLine{320   \textcolor{keywordtype}{double} brakingCoefficient = 1.0;}
\DoxyCodeLine{321 }
\DoxyCodeLine{322   \textcolor{keywordtype}{void} setDeviceMode(\textcolor{keywordtype}{int} deviceMode);}
\DoxyCodeLine{323   \textcolor{keywordtype}{void} powerEnable(\textcolor{keywordtype}{bool} val);}
\DoxyCodeLine{324 \};}
\DoxyCodeLine{325 }
\DoxyCodeLine{326 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// HARDWAREGLOBALINTERFACE\_H}}

\end{DoxyCode}
